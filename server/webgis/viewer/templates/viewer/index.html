{% load staticfiles %}

<!doctype html>
<html lang="en" ng-app="gl.web">
  <head>
    <meta charset="utf-8">

    <title>GIS.lab Web</title>

    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Roboto:300,400,500,700"/>
    <link rel="stylesheet" type="text/css" href="{% static "styles/map.min.css" %}"/>

    <!-- Before body closing tag -->
    <script src="{% static "js/deps.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/ol3-deps.min.js" %}"></script>

    <script type="text/javascript">
    // First, checks if it isn't implemented yet.
    if (!String.prototype.format) {
      String.prototype.format = function() {
        var args = arguments;
        return this.replace(/{(\d+)}/g, function(match, number) {
          return typeof args[number] != 'undefined'
            ? args[number]
            : match
          ;
        });
      };
    }
    </script>
    <script type="text/javascript" src="{% static "js/app.min.js" %}"></script>

    <script type="text/javascript">
      if (!location.search) {
        location.search = "PROJECT=vagrant/natural-earth/central-europe";
      }
      angular.module('gl.web')
        .constant('staticResources', {
          'text-logo': 'static/styles/text_logo.svg',
          'login-text-logo': 'static/styles/login_text_logo.svg',
          'image-logo': 'static/styles/image_logo.svg',
          'geolocation-tracking': 'static/styles/geolocation_tracking.png'
        })
        .config(function($mdIconProvider) {
          $mdIconProvider
            .defaultIconSet('{% static "styles/icons.svg" %}', 32)
        })
        .run(function($timeout, projectLoader, gislabClient) {
          var data = JSON.parse('{{ jsonData|default:"{}"|escapejs }}');
          gislabClient.userInfo = data.user;
          projectLoader.setProjectData(data.project);
        });
    </script>
  </head>
  <body
    class="no-scrollbar"
    ng-controller="AppLoader">
    <div
      ng-if="appInitialized"
      ng-controller="AppController"
      style="width:100%; height:100%;">
      <div
        style="width:100%; height:100%;"
        ng-include="'templates/app.html'"
        onload="initializeApp()">
      </div>
    </div>
  </body>
</html>
